# Generation Tests

This directory contains the results of automated generation tests for the Page Builder Chat system.

## Structure

```
.generation-tests/
├── README.md                    # This file
└── results/                    # Individual test results
    └── [timestamp]-[test-name]/ # Each test gets its own timestamped directory
        ├── test-result.json    # Complete test result
        ├── planner-result.json # Planner agent output
        ├── structure-result.json # Structure agent output (ACT)
        ├── merger-result.json  # Merger agent output (Kendo components)
        ├── mcp-queries.json    # MCP queries sent to server
        └── mcp-responses.json  # MCP server responses
```

**Note**: Test directories are timestamped (e.g., `2025-01-14T19-00-00-modern-saas-dashboard`) to allow multiple test runs without overwriting previous results.

## Running Tests

To run all generation tests:

```bash
npm run test:generation
```

This will:

1. Load test queries from `test-queries.json`
2. Run each query through the full generation pipeline
3. Save all intermediate results to timestamped directories in `.generation-tests/results/`
4. Display test execution progress and timing information

## Test Queries

Test queries are defined in `test-queries.json` with the following format:

```json
[
  {
    "title": "Test Name",
    "query": "User query for page generation"
  }
]
```

## Understanding Results

### Test Result Structure

Each test produces a `test-result.json` with:

```json
{
  "title": "Test Name",
  "query": "User query",
  "success": true/false,
  "error": "Error message if failed",
  "executionTime": 12345,
  "timestamp": "2025-01-14T19:00:00.000Z",
  "results": {
    "planner": { /* Planner agent output */ },
    "structure": { /* Structure agent output */ },
    "merger": { /* Merger agent output */ },
    "mcpQueries": { /* MCP queries sent */ },
    "mcpResponses": { /* MCP server responses */ }
  }
}
```

### Agent Outputs

- **Planner**: Creates execution plan for page generation
- **Structure**: Generates Abstract Component Tree (ACT) with MCP queries
- **Merger**: Converts ACT to Kendo UI components using MCP responses
- **MCP Queries**: Dynamic queries generated by structure agent
- **MCP Responses**: Documentation retrieved from MCP server

## Analyzing Results

1. **Check console output** for real-time test execution progress and timing
2. **Examine individual timestamped test directories** for detailed results
3. **Review MCP queries and responses** to understand documentation quality
4. **Compare structure vs merger outputs** to see component mapping effectiveness
5. **Look for timestamp patterns** to track test run history and performance over time

## Debugging Failed Tests

If a test fails:

1. Check the `error` field in `test-result.json`
2. Look at individual agent outputs to see where it failed
3. Review MCP queries to see if they're generating appropriate requests
4. Check MCP responses for quality and relevance

## Adding New Tests

To add new test queries:

1. Edit `test-queries.json`
2. Add new entries with `title` and `query` fields
3. Run `npm run test:generation` to execute all tests

## Performance Monitoring

The test system tracks:

- Execution time for each test (displayed in console)
- Test run timestamps for historical analysis
- Success/failure rates per test run
- Individual agent performance
- MCP query and response quality

**Current Configuration**: The test script is currently configured to run only the first test query for faster iteration during development. To run all tests, modify the loop condition in `scripts/run-generation-tests.ts`.

Use this data to identify performance bottlenecks and optimization opportunities.
